<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>DC-net</title>
  <link href='/public/main.css' media='all' rel='stylesheet' type='text/css' />
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">
</head>

<body>
  <div id="main"></div>
  <script src='/public/main.js'></script>

  <ul id="messages"></ul>
  <!-- <form id="chat-message" action="">
    <input id="message" autocomplete="off" /><button>Send</button>
  </form> -->

  <!-- Columns are always 50% wide, on mobile and desktop -->
  <div class="row fixed-bottom secret-bit-question">
    <div class="col-12">
      <h2 class="question">Would you like to pay for the dinner?</h2>
    </div>
    <div class="col-2 offset-4 choice-button-container">
      <button type="button" id="yes-payer" class="choice-button btn btn-success btn-lg">YES</button>
    </div>
    <div class="col-2 choice-button-container">
      <button type="button" id="no-payer" class="choice-button btn btn-danger btn-lg">NO</button>
    </div>
  </div>

</body>
<!-- <script src="/socket.io/socket.io.js"></script> -->
<script src="js/jquery-1.11.1.js"></script>
<script type="text/javascript">
  $(function() {
    // var socket = io();

    // $('#chat-message').submit(function() {
      // socket.emit("in-message", socket.id, $("#message").val());
    //   $("#message").val('');
    //   return false;
    // });

    $('.secret-bit-question').css('visibility', 'hidden');

    // socket.on('reset', function() {
    //   // hide choice
    //   $('.secret-bit-question').css('visibility', 'hidden');
    //
    //   // delete messages
    //   while(document.body.children.messages.hasChildNodes()) {
    //     document.body.children.messages.removeChild(document.body.children.messages.lastChild);
    //   }
    //
    //   sessionStorage.clear();
    // });

    // socket.on('system-message', function(type, message) {
    //   $('#messages').append($('<li>').text(message).css('font-weight', 'bold'));
    // });
    //
    // socket.on('key-exchange', function(keyName, key) {
    //   sessionStorage.setItem(keyName, key);
    //   if (sessionStorage.length == 2) {
    //     sleep(1000);
    //     $('.secret-bit-question').css('visibility', 'visible');
    //   }
    // });

    $('#yes-payer').click(function() {
      var result = 1;
      $('.secret-bit-question').css('visibility', 'hidden');
      for(var x=0; x<sessionStorage.length; ++x) {
        result += parseInt(sessionStorage.getItem(sessionStorage.key(x)));
      }
      result = result % 2;
      // socket.emit("client-value", result);
    });

    $('#no-payer').click(function() {
      var result = 0;
      $('.secret-bit-question').css('visibility', 'hidden');
      for(var x=0; x<sessionStorage.length; ++x) {
        result += parseInt(sessionStorage.getItem(sessionStorage.key(x)));
      }
      result = result % 2;
      // socket.emit("client-value", result);
    });

    // socket.on('key-exchange-progress', function(message){
    //   sleep(300);
    //   $('#messages').append($('<li>').text(message).css('font-weight', 'bold'));
    // });


    // force a delay to ease understanding of the simulation
    function sleep(milliseconds) {
      var start = new Date().getTime();
      for (var i = 0; i < 1e7; i++) {
        if ((new Date().getTime() - start) > milliseconds){
          break;
        }
      }
    }

  });
</script>
</html>
